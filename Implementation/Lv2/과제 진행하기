import java.util.*;
import java.io.*;

class Solution {
    
    static class Info {
        String name;
        int start;
        int playtime;
        Info(String n, int s, int p) {
            name = n;
            start = s;
            playtime = p;
        }
    }
    
    public String[] solution(String[][] plans) {
        int n = plans.length;
        String[] answer = new String[n];
        Info[] planSet = new Info[n];
        for(int i = 0; i < n; ++i) {
            planSet[i] = new Info(plans[i][0], convert(plans[i][1]), Integer.parseInt(plans[i][2]));
        }
        Arrays.sort(planSet, (o1, o2) -> {
            return Integer.compare(o1.start, o2.start);
        });
        int index = 0;
        Deque<Info> q = new ArrayDeque<>();
        for(int i = 0; i < n - 1; ++i) {
            Info cur = planSet[i];
            Info next = planSet[i + 1];
            int endTime = cur.start + cur.playtime;
            //다음 과제 시작 전 현재 과제를 완료할 수 없을 때
            if(endTime > next.start) {
                cur.playtime = endTime - next.start;
                q.addLast(cur);
                continue;
            }
            //완료할 수 있다면 당장의 계획은 정답에 추가
            answer[index++] = cur.name;
            //남은시간동안 가능한 과제 구하기
            int rest = next.start - endTime;
            while(rest > 0 && !q.isEmpty()) {
                Info stopped = q.pollLast();
                //남은 시간에서 현재 진행할 시간을 뺐을 때, 남은 시간이 0보다 크면 지속한다 
                int diff = rest - stopped.playtime;
                //만약 남은 시간보다 더 많이 해야하는 과제라면, 다시 큐에 집어넣는다
                if(diff < 0) {
                    stopped.playtime = -diff;
                    q.addLast(stopped);
                    break;
                }
                rest = diff;
                answer[index++] = stopped.name;
            }
        }
        answer[index++] = planSet[n - 1].name;
        while(!q.isEmpty()) {
            Info cur = q.pollLast();
            answer[index++] = cur.name;
        }
        return answer;
    }
    
    static int convert(String time) {
        int hour = Integer.parseInt(time.substring(0, 2));
        int minute = Integer.parseInt(time.substring(3));
        return hour * 60 + minute;
    }
}
